define(function(){"use strict";var t=function(t,n){this.q=[],this.updateInterval=1e3,this.currentEvent=0,this.upcomingEvent=0,this.updateTimer=void 0,this.onStart=function(){},void 0!==t&&(this.onStart=t),this.onUpdate=function(){},void 0!==n&&(this.onUpdate=n)};return t.prototype={add:function(t,n){this.q.push({event:t,end:eventTime.end,start:eventTime.start})},terminate:function(t){},remove:function(t){this.q.splice(t,1)},start:function(){this.order(),this.onStart();var t=this;this.updateTimer=setInterval(function(){t.update()},this.updateInterval)},stop:function(){clearInterval(this.updateTimer)},index:function(t){for(var n in this.q)if(this.q[n].id===t)return n;return void 0},order:function(){this.q.sort(function(t,n){return t.end-n.end}),this.update()},update:function(){for(var t in this.q){var n=(new Date).getTime(),i=t;i<this.q.length-1&&++i,this.q[i].start-n<=0&&(this.upcomingEvent-=1,this.upcomingEvent<1&&(this.upcomingEvent=1),this.remove(this.currentEvent),this.onUpdate())}}},t});