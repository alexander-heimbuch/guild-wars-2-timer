!function(){"use strict";var t=$("#stage"),e=$("#timer").final_countdown({seconds:{borderColor:"#fff",borderWidth:"15"},minutes:{borderColor:"#fff",borderWidth:"15"},hours:{borderColor:"#fff",borderWidth:"15"},centerLabels:!0}),n=$("#current-event .event-title"),i=function(t,e){var n=$(e).data(),i={id:n.id,container:$(e)[0].outerHTML,timers:n.timers};$(e).remove(),r.add(n.id,i)},r={list:{},add:function(t,e){this.list[t]=e,this.terminate(t)},activationTime:function(t){var e=new Date,n=new Date,i={start:0,end:0},r=parseInt(t.split(":").shift()),a=parseInt(t.split(":").pop());n.setHours(r),n.setMinutes(a),r<n.getHours()&&n.setDate(n.getDate()+1);var s=Date.UTC(n.getUTCFullYear(),n.getUTCMonth(),n.getUTCDate(),n.getUTCHours(),n.getUTCMinutes())-Date.UTC(e.getUTCFullYear(),e.getUTCMonth(),e.getUTCDate(),e.getUTCHours(),e.getUTCMinutes(),e.getUTCSeconds(),e.getUTCMilliseconds()),o=Date.UTC(e.getUTCFullYear(),e.getUTCMonth(),e.getUTCDate(),e.getUTCHours(),e.getUTCMinutes())+s,u=3e5;return i.start=Math.round(o/u)*u,i.end=s,i},terminate:function(t){var e=this;this.list[t].timers.forEach(function(n){var i=e.activationTime(n);i.end>=-9e5&&a.add(t,i)})},initStage:function(e){var n=this;a.q.forEach(function(i){var s=$(n.list[i.event].container),o=new Date(i.start),u=o.getHours(),d=o.getMinutes(),c=$('<span class="mark-as-finished">&#10003;</span>');s.find(".start-time").html(u+":"+(10>d?"0":"")+d),c.on("click",function(){return a.q.forEach(function(t,e){t.event===i.event&&(n.unstage(e),a.remove(e),e===a.upcomingEvent&&r.stage(a.upcomingEvent))}),!1}),s.find("h3").append(c),s.on("click",e),t.append(s)})},unstage:function(e){t.find("li").eq(e).remove(),this.unbind(a.currentEvent,"click")},unbind:function(e,n){t.find("li").eq(e).unbind(n)},stage:function(n){t.find(".staged").removeClass("staged"),t.find("li").eq(n).addClass("staged"),e.set(parseInt((new Date).getTime()/1e3),parseInt(a.q[n].start/1e3),parseInt((new Date).getTime()/1e3)),e.start()}},a={q:[],updateInterval:1e3,currentEvent:0,upcomingEvent:1,add:function(t,e){this.q.push({event:t,end:e.end,start:e.start})},remove:function(t){this.q.splice(t,1)},start:function(){a.order(),setInterval(s,this.updateInterval)},index:function(t){for(var e in this.q)if(this.q[e].id===t)return e;return void 0},order:function(){this.q.sort(function(t,e){return t.end-e.end}),s(),r.initStage(function(){var t=$(this).index();r.stage(t),a.activeIndex=t}),r.unbind(0,"click"),r.stage(this.upcomingEvent)}},s=function(){for(var t in a.q){var e=(new Date).getTime(),n=t;n<a.q.length-1&&++n,a.q[n].start-e<=0&&(a.upcomingEvent-=1,a.upcomingEvent<1&&(a.upcomingEvent=1),a.remove(a.currentEvent),r.unstage(a.currentEvent),r.stage(a.upcomingEvent))}};t.find("li").each(i),a.start()}();